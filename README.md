<h1 align="center">ğŸ‘‹ XÃ‚Y Dá»°NG Há»† THá»NG Gá»¢I Ã THá»°C ÄÆ N DINH DÆ¯á» NG CÃ NHÃ‚N HÃ“A ğŸ¥—</h1>

<div align="center">
Â Â 
Â  <p align="center">
Â  Â  <img src="images/logo.png" alt="Dai Nam Logo" width="200"/>
Â  Â  <img src="images/AIoTLab_logo.png" alt="AIoTLab Logo" width="200"/>
Â  </p>

Â  [![Made by AIoTLab](https://img.shields.io/badge/Made%20by%20AIoTLab-blue?style=for-the-badge)](https://www.facebook.com/DNUAIoTLab)
Â  [![Fit DNU](https://img.shields.io/badge/Fit%20DNU-green?style=for-the-badge)](https://fitdnu.net/)
Â  [![DaiNam University](https://img.shields.io/badge/DaiNam%20University-red?style=for-the-badge)](https://dainam.edu.vn)

</div>

<h2 align="center">ğŸ’¡ Giáº£i phÃ¡p gá»£i Ã½ thá»±c Ä‘Æ¡n thÃ´ng minh dá»±a trÃªn dá»¯ liá»‡u cÃ¡ nhÃ¢n<</h2>

<p align="left">
Â  Dá»± Ã¡n nÃ y xÃ¢y dá»±ng má»™t há»‡ thá»‘ng **gá»£i Ã½ thá»±c Ä‘Æ¡n dinh dÆ°á»¡ng cÃ¡ nhÃ¢n hÃ³a** sá»­ dá»¥ng dá»¯ liá»‡u ngÆ°á»i dÃ¹ng, thÃ´ng tin thÃ nh pháº§n dinh dÆ°á»¡ng vÃ  mÃ´ hÃ¬nh **Há»c mÃ¡y/Deep Learning**. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ nháº­p thÃ´ng tin cÃ¡ nhÃ¢n (tuá»•i, cÃ¢n náº·ng, chiá»u cao, má»¥c tiÃªu dinh dÆ°á»¡ng) vÃ  nháº­n Ä‘Æ°á»£c cÃ¡c Ä‘á» xuáº¥t mÃ³n Äƒn phÃ¹ há»£p vá»›i nhu cáº§u dinh dÆ°á»¡ng, sá»Ÿ thÃ­ch vÃ  cháº¿ Ä‘á»™ Äƒn uá»‘ng. Há»‡ thá»‘ng káº¿t há»£p phÃ¢n tÃ­ch dá»¯ liá»‡u, tiá»n xá»­ lÃ½ vÃ  mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n Ä‘á»ƒ tá»‘i Æ°u hÃ³a cháº¿ Ä‘á»™ Äƒn má»™t cÃ¡ch thÃ´ng minh vÃ  tiá»‡n lá»£i. ğŸš€
</p>

---

## ğŸŒŸ Giá»›i thiá»‡u há»‡ thá»‘ng

- **Dá»¯ liá»‡u dinh dÆ°á»¡ng:** Bao gá»“m calo, protein, carbohydrate, cháº¥t bÃ©o, vitamin vÃ  khoÃ¡ng cháº¥t.
- **MÃ´ hÃ¬nh AI:** Sá»­ dá»¥ng cÃ¡c thuáº­t toÃ¡n ML/DL (Random Forest, LSTM, hoáº·c Máº¡ng nÆ¡-ron) Ä‘á»ƒ gá»£i Ã½ thá»±c Ä‘Æ¡n.
- **Giao diá»‡n tÆ°Æ¡ng tÃ¡c:** Web app/GUI cho phÃ©p ngÆ°á»i dÃ¹ng nháº­p dá»¯ liá»‡u, nháº­n Ä‘á» xuáº¥t, Ä‘Ã¡nh giÃ¡ vÃ  lÆ°u láº¡i cÃ¡c bá»¯a Äƒn.
- **TÃ¹y chá»‰nh cÃ¡ nhÃ¢n:** Äiá»u chá»‰nh theo lÆ°á»£ng calo má»¥c tiÃªu, dá»‹ á»©ng, sá»Ÿ thÃ­ch mÃ³n Äƒn hoáº·c cháº¿ Ä‘á»™ Äƒn Ä‘áº·c biá»‡t (Vegetarian, Keto, Low-carbâ€¦).

---

## ğŸ—ï¸ Kiáº¿n trÃºc há»‡ thá»‘ng

Há»‡ thá»‘ng gá»“m 3 khá»‘i chÃ­nh:

1. **Khá»‘i Dá»¯ liá»‡u:** Thu tháº­p dá»¯ liá»‡u thá»±c pháº©m, thÃ nh pháº§n dinh dÆ°á»¡ng, dá»¯ liá»‡u ngÆ°á»i dÃ¹ng.
2. **Khá»‘i Xá»­ lÃ½ & AI:** Tiá»n xá»­ lÃ½ dá»¯ liá»‡u, chuáº©n hÃ³a, xÃ¢y dá»±ng vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n thá»±c Ä‘Æ¡n phÃ¹ há»£p.
3. **Khá»‘i Giao diá»‡n NgÆ°á»i dÃ¹ng:** Web app/GUI hiá»ƒn thá»‹ gá»£i Ã½ thá»±c Ä‘Æ¡n vÃ  cho phÃ©p tÆ°Æ¡ng tÃ¡c.

![Kiáº¿n trÃºc há»‡ thá»‘ng](images/architecture.png)

---

## ğŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

```
project/
â”‚
â”œâ”€ raw-data_recipe.csv # Dá»¯ liá»‡u gá»‘c cÃ¡c cÃ´ng thá»©c náº¥u Äƒn
â”œâ”€ Food_and_Nutrition__.csv # Dá»¯ liá»‡u thÃ´ng tin ngÆ°á»i dÃ¹ng
â”œâ”€ recipes_clean.csv # Dá»¯ liá»‡u Ä‘Ã£ lÃ m sáº¡ch
â”œâ”€ model_cal.pkl # MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n nhu cáº§u calo
â”œâ”€ model_prot.pkl # MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n nhu cáº§u protein
â”œâ”€ app.py # á»¨ng dá»¥ng Streamlit cho ngÆ°á»i dÃ¹ng
â”œâ”€ xu_ly_du_lieu.ipynb # Notebook tiá»n xá»­ lÃ½, huáº¥n luyá»‡n mÃ´ hÃ¬nh
â””â”€ README.md # HÆ°á»›ng dáº«n dá»± Ã¡nÂ  Â  Â  Â  
```


---

## ğŸ› ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng

- **Python**: Pandas, NumPy, ast, Matplotlib
- **Machine Learning**: scikit-learn (RandomForestRegressor, StandardScaler, KMeans)
- **Text Processing**: TfidfVectorizer
- **Web App**: Streamlit
- **Serialization**: Pickle

---

## ğŸ› ï¸ YÃªu cáº§u há»‡ thá»‘ng

### Pháº§n má»m
- Python 3.x
- ThÆ° viá»‡n: `numpy`, `pandas`, `scikit-learn`, `tensorflow`, `joblib`, `streamlit`, `matplotlib`, `seaborn`

### LÆ°u Ã½
- Chuáº©n hÃ³a dá»¯ liá»‡u ngÆ°á»i dÃ¹ng vÃ  dá»¯ liá»‡u thá»±c pháº©m trÆ°á»›c khi huáº¥n luyá»‡n.
- MÃ¡y tÃ­nh cÃ³ GPU sáº½ tÄƒng tá»‘c quÃ¡ trÃ¬nh huáº¥n luyá»‡n mÃ´ hÃ¬nh Machine Learning.

---

## ğŸ”¹ Xá»­ lÃ½ dá»¯ liá»‡u

1. **Äá»c dá»¯ liá»‡u**: `raw-data_recipe.csv` chá»©a thÃ´ng tin cÃ´ng thá»©c, nguyÃªn liá»‡u, dinh dÆ°á»¡ng.
2. **LÃ m sáº¡ch dá»¯ liá»‡u**:
   - Bá» cÃ¡c cá»™t khÃ´ng cáº§n thiáº¿t: `aver_rate`, `image_url`, `reviews`, `review_nums`.
   - Parse cá»™t `nutritions` tá»« chuá»—i JSON sang cÃ¡c cá»™t dinh dÆ°á»¡ng: `calories`, `protein`, `fat`, `carbohydrates`, `fiber`, `sodium`.
   - TÃ¡ch danh sÃ¡ch nguyÃªn liá»‡u (`ingredients_list`).
3. **Xuáº¥t dá»¯ liá»‡u sáº¡ch**: `recipes_clean.csv`.

```python
df_final.to_csv('recipes_clean.csv', index=False)
4. **Lá»c mÃ³n Äƒn theo thÃ³i quen:**:
   - TrÃ¡nh thá»±c pháº©m ngÆ°á»i dÃ¹ng khÃ´ng thÃ­ch.
   - Æ¯u tiÃªn thá»±c pháº©m ngÆ°á»i dÃ¹ng yÃªu cáº§u.

## ğŸ”¹ TÃ­nh toÃ¡n chá»‰ sá»‘ cÆ¡ thá»ƒ

- **BMI**: 

\[
BMI = \frac{\text{weight\_kg}}{(\text{height\_m})^2}
\]

- **TDEE (Total Daily Energy Expenditure)**: dá»±a trÃªn BMR, giá»›i tÃ­nh, tuá»•i, chiá»u cao, cÃ¢n náº·ng vÃ  má»©c Ä‘á»™ váº­n Ä‘á»™ng.

- **Äiá»u chá»‰nh TDEE theo BMI**:

  - BMI > 25 â†’ giáº£m 15%
  - BMI < 18.5 â†’ tÄƒng 15%

```python
def adjust_tdee(row):
    if row['BMI'] > 25:
        return row['tdee'] * 0.85
    elif row['BMI'] < 18.5:
        return row['tdee'] * 1.15
    else:
        return row['tdee']
- **Nhu cáº§u protein: 2g / kg trá»ng lÆ°á»£ng cÆ¡ thá»ƒ.
---

## ğŸ”¹ Huáº¥n luyá»‡n mÃ´ hÃ¬nh AI

- **Dá»¯ liá»‡u Ä‘áº§u vÃ o**: BMI, tuá»•i, giá»›i tÃ­nh, chiá»u cao, cÃ¢n náº·ng, má»©c Ä‘á»™ váº­n Ä‘á»™ng
- **Má»¥c tiÃªu dá»± Ä‘oÃ¡n**: `target_calories` vÃ  `target_protein`
- **MÃ´ hÃ¬nh sá»­ dá»¥ng**: `RandomForestRegressor`
- **ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh**:
  - RÂ² Score
  - MAE (Mean Absolute Error)
  - RMSE (Root Mean Squared Error)

- **LÆ°u mÃ´ hÃ¬nh**:

```python
with open('model_cal.pkl', 'wb') as f:
    pickle.dump(model_cal, f)

with open('model_prot.pkl', 'wb') as f:
    pickle.dump(model_prot, f)

# ğŸ¥— Tá»•ng quan Há»‡ thá»‘ng Gá»£i Ã½ Thá»±c Ä‘Æ¡n CÃ¡ nhÃ¢n (AI Nutrition Recommender)

Dá»± Ã¡n nÃ y sá»­ dá»¥ng Há»c mÃ¡y (Machine Learning) vÃ  Thuáº­t toÃ¡n tá»‘i Æ°u hÃ³a Ä‘á»ƒ táº¡o ra thá»±c Ä‘Æ¡n Äƒn uá»‘ng hÃ ng ngÃ y Ä‘Æ°á»£c cÃ¡ nhÃ¢n hÃ³a dá»±a trÃªn thÃ´ng tin cÆ¡ thá»ƒ (BMI), má»¥c tiÃªu cÃ¢n náº·ng, vÃ  thÃ³i quen Äƒn uá»‘ng cá»§a ngÆ°á»i dÃ¹ng.

---

## ğŸ’» á»¨ng dá»¥ng Streamlit vÃ  TÃ­nh nÄƒng CÃ¡ nhÃ¢n hÃ³a

á»¨ng dá»¥ng Ä‘Æ°á»£c triá»ƒn khai báº±ng Streamlit, cung cáº¥p giao diá»‡n trá»±c quan vÃ  cÃ¡c tÃ­nh nÄƒng chÃ­nh sau:

### âš™ï¸ Sidebar: Thu tháº­p ThÃ´ng tin NgÆ°á»i dÃ¹ng

* **ThÃ´ng sá»‘ Sinh há»c:** Nháº­p **Tuá»•i**, **Giá»›i tÃ­nh**, **Chiá»u cao**, **CÃ¢n náº·ng**.
* **Hoáº¡t Ä‘á»™ng & Má»¥c tiÃªu:** Chá»n **Má»©c Ä‘á»™ váº­n Ä‘á»™ng** vÃ  **Má»¥c tiÃªu cÃ¢n náº·ng** (`giáº£m cÃ¢n`, `giá»¯ cÃ¢n`, `tÄƒng cÃ¢n`).
* **Sá»Ÿ thÃ­ch CÃ¡ nhÃ¢n:** Nháº­p **Thá»±c pháº©m muá»‘n trÃ¡nh / Æ°u tiÃªn** (sá»­ dá»¥ng Ä‘á»ƒ lá»c cÃ´ng thá»©c).

### ğŸŒŸ TÃ­nh nÄƒng ChÃ­nh

* **Dá»± Ä‘oÃ¡n Nhu cáº§u:** MÃ´ hÃ¬nh Random Forest Regressor dá»± Ä‘oÃ¡n **Calo** vÃ  **Protein** cáº§n thiáº¿t hÃ ng ngÃ y (Ä‘Æ°á»£c Ä‘iá»u chá»‰nh theo BMI vÃ  Má»¥c tiÃªu).
* **Lá»c CÃ´ng thá»©c:** Lá»c cÃ´ng thá»©c dá»±a trÃªn sá»Ÿ thÃ­ch (`avoid_foods`/`prefer_foods`) vÃ  nhÃ³m mÃ³n Äƒn.
* **Chia Bá»¯a Ä‚n:** Thá»±c Ä‘Æ¡n Ä‘Æ°á»£c chia thÃ nh 4 bá»¯a: **Bá»¯a sÃ¡ng**, **Bá»¯a trÆ°a**, **Bá»¯a tá»‘i**, **Bá»¯a phá»¥**.
* **Hiá»ƒn thá»‹ Chi tiáº¿t:** Báº£ng káº¿t quáº£ hiá»ƒn thá»‹ chi tiáº¿t **Calo**, **Protein (g)**, **Cháº¥t bÃ©o (g)** vÃ  **NhÃ³m mÃ³n** (Cluster) cá»§a tá»«ng mÃ³n Äƒn.
* **Gá»£i Ã½ Thay tháº¿:** Gá»£i Ã½ mÃ³n Äƒn thay tháº¿ dá»±a trÃªn **nhÃ³m cluster mÃ³n Äƒn** (cÃ¹ng nhÃ³m dinh dÆ°á»¡ng/thÃ nh pháº§n).
* **Lá»‹ch sá»­:** LÆ°u **Lá»‹ch sá»­ thá»±c Ä‘Æ¡n** tá»‘i Ä‘a 10 láº§n táº¡o.

---

## ğŸ”¬ Clustering CÃ´ng thá»©c MÃ³n Äƒn (KMeans)

Äá»ƒ phÃ¢n loáº¡i vÃ  gá»£i Ã½ mÃ³n thay tháº¿ há»£p lÃ½, chÃºng tÃ´i Ä‘Ã£ Ã¡p dá»¥ng thuáº­t toÃ¡n **KMeans Clustering** trÃªn dá»¯ liá»‡u cÃ´ng thá»©c.

* **Ká»¹ thuáº­t Feature Engineering:**
    * **TF-IDF** trÃªn trÆ°á»ng **NguyÃªn liá»‡u** Ä‘á»ƒ nháº­n diá»‡n thÃ nh pháº§n nguyÃªn liá»‡u.
    * **Chuáº©n hÃ³a (StandardScaler)** cÃ¡c trÆ°á»ng **dinh dÆ°á»¡ng chÃ­nh** (Calo, Protein, Fat, Carb, Fiber, Sodium).
    * Káº¿t há»£p hai vector nÃ y Ä‘á»ƒ táº¡o ra ma tráº­n Ä‘áº§u vÃ o cho Clustering.
* **PhÃ¢n loáº¡i (5 Cluster):**
    * **Low-Calorie** (Ã­t calo)
    * **High-Protein** (nhiá»u protein)
    * **Balanced** (cÃ¢n báº±ng)
    * **High-Fat** (nhiá»u cháº¥t bÃ©o)
    * **Carb-Heavy** (nhiá»u tinh bá»™t)

### ğŸ“Š VÃ­ dá»¥ Káº¿t quáº£ Thá»±c Ä‘Æ¡n

| Bá»¯a | MÃ³n Äƒn | Calo | Protein (g) | Cháº¥t bÃ©o (g) | NhÃ³m mÃ³n |
| :---: | :---: | :---: | :---: | :---: | :---: |
| Bá»¯a sÃ¡ng | Trá»©ng á»‘p la | 300 | 20 | 15 | High-Protein |
| Bá»¯a trÆ°a | CÆ¡m gÃ  | 550 | 35 | 20 | Balanced |
| Bá»¯a tá»‘i | Salad cÃ¡ há»“i | 400 | 25 | 18 | Low-Calorie |
| Bá»¯a phá»¥ | Sá»¯a chua | 150 | 8 | 5 | Balanced |

---

## ğŸ“ˆ HÃ¬nh áº£nh Trá»±c quan & ÄÃ¡nh giÃ¡ MÃ´ hÃ¬nh AI

CÃ¡c biá»ƒu Ä‘á»“ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cá»§a mÃ´ hÃ¬nh Random Forest Regressor:

* **Scatter plot:** So sÃ¡nh giÃ¡ trá»‹ **thá»±c táº¿ (Ground Truth)** vÃ  **dá»± Ä‘oÃ¡n** cho Calo vÃ  Protein (Äá»™ gáº§n cá»§a cÃ¡c Ä‘iá»ƒm so vá»›i Ä‘Æ°á»ng $y=x$ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t mÃ´ hÃ¬nh).
* **Histogram:** PhÃ¢n phá»‘i **Sai sá»‘ (Residuals)** giÃºp kiá»ƒm tra Ä‘á»™ chá»‡ch vÃ  Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh.
* CÃ¡c biá»ƒu Ä‘á»“ nÃ y giÃºp **Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ mÃ´ hÃ¬nh AI** trong viá»‡c xÃ¡c Ä‘á»‹nh nhu cáº§u dinh dÆ°á»¡ng cÃ¡ nhÃ¢n.

---

## ğŸš€ HÆ°á»›ng dáº«n Cháº¡y á»¨ng dá»¥ng

Äá»ƒ khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng Streamlit cá»¥c bá»™, thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:

1.  **CÃ i Ä‘áº·t ThÆ° viá»‡n:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **Khá»Ÿi Ä‘á»™ng á»¨ng dá»¥ng:**
    ```bash
    streamlit run app_multilang_full.py
    ```
3.  **Sá»­ dá»¥ng:** Nháº­p thÃ´ng tin cÃ¡ nhÃ¢n trÃªn **Sidebar**, sau Ä‘Ã³ nháº¥n **Táº¡o thá»±c Ä‘Æ¡n AI** Ä‘á»ƒ xem gá»£i Ã½. MÃ³n thay tháº¿ cÃ³ thá»ƒ chá»n trá»±c tiáº¿p Ä‘á»ƒ cáº­p nháº­t thá»±c Ä‘Æ¡n.

---

## âœ… Káº¿t luáº­n vÃ  HÆ°á»›ng phÃ¡t triá»ƒn

### ğŸ“Œ GiÃ¡ trá»‹ Há»‡ thá»‘ng

Há»‡ thá»‘ng giÃºp ngÆ°á»i dÃ¹ng:
* **Dá»± Ä‘oÃ¡n nhu cáº§u** Calo/Protein chÃ­nh xÃ¡c theo cÆ¡ thá»ƒ vÃ  hoáº¡t Ä‘á»™ng.
* **Táº¡o thá»±c Ä‘Æ¡n cÃ¢n báº±ng** vÃ  Ä‘Æ°á»£c **cÃ¡ nhÃ¢n hÃ³a** theo má»¥c tiÃªu.
* **Lá»c mÃ³n Äƒn** theo sá»Ÿ thÃ­ch vÃ  thÃ³i quen.
* **Gá»£i Ã½ mÃ³n thay tháº¿** Ä‘á»ƒ Ä‘a dáº¡ng hÃ³a bá»¯a Äƒn mÃ  váº«n giá»¯ nguyÃªn nhÃ³m dinh dÆ°á»¡ng.

### ğŸŒŸ Má»Ÿ rá»™ng trong TÆ°Æ¡ng lai

* **Dá»¯ liá»‡u:** ThÃªm dá»¯ liá»‡u dinh dÆ°á»¡ng chi tiáº¿t hÆ¡n (nhÆ° cháº¥t bÃ©o bÃ£o hÃ²a, Ä‘Æ°á»ng, vitamin, khoÃ¡ng cháº¥t).
* **Thuáº­t toÃ¡n:** Tá»‘i Æ°u thuáº­t toÃ¡n chá»n mÃ³n báº±ng cÃ¡c ká»¹ thuáº­t **Tá»‘i Æ°u hÃ³a (Optimization)** Ä‘á»ƒ Ä‘áº£m báº£o thá»±c Ä‘Æ¡n **tá»•ng thá»ƒ** Ä‘áº¡t chÃ­nh xÃ¡c cÃ¡c má»¥c tiÃªu dinh dÆ°á»¡ng vÄ© mÃ´.
* **Giao diá»‡n:** Há»— trá»£ Ä‘a ngÃ´n ngá»¯ vÃ  giao diá»‡n di Ä‘á»™ng.
## ğŸ¤ TÃC GIáº¢ ğŸ‘¥

Dá»± Ã¡n Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi:

- **Tráº§n Há»“ng QuÃ¢n**

Â© 2025 NHÃ“M 20, KHOA CÃ”NG NGHá»† THÃ”NG TIN, TRÆ¯á»œNG Äáº I Há»ŒC Äáº I NAM.

