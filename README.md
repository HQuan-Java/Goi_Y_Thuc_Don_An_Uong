<h1 align="center">ğŸ‘‹ XÃ‚Y Dá»°NG Há»† THá»NG Gá»¢I Ã THá»°C ÄÆ N DINH DÆ¯á» NG CÃ NHÃ‚N HÃ“A ğŸ¥—</h1>

<div align="center">
Â Â 
Â  <p align="center">
Â  Â  <img src="images/logo.png" alt="Dai Nam Logo" width="200"/>
Â  Â  <img src="images/AIoTLab_logo.png" alt="AIoTLab Logo" width="200"/>
Â  </p>

Â  [![Made by AIoTLab](https://img.shields.io/badge/Made%20by%20AIoTLab-blue?style=for-the-badge)](https://www.facebook.com/DNUAIoTLab)
Â  [![Fit DNU](https://img.shields.io/badge/Fit%20DNU-green?style=for-the-badge)](https://fitdnu.net/)
Â  [![DaiNam University](https://img.shields.io/badge/DaiNam%20University-red?style=for-the-badge)](https://dainam.edu.vn)

</div>

<h2 align="center">ğŸ’¡ Giáº£i phÃ¡p gá»£i Ã½ thá»±c Ä‘Æ¡n thÃ´ng minh dá»±a trÃªn dá»¯ liá»‡u cÃ¡ nhÃ¢n<</h2>

<p align="left">
Â  Dá»± Ã¡n nÃ y xÃ¢y dá»±ng má»™t há»‡ thá»‘ng **gá»£i Ã½ thá»±c Ä‘Æ¡n dinh dÆ°á»¡ng cÃ¡ nhÃ¢n hÃ³a** sá»­ dá»¥ng dá»¯ liá»‡u ngÆ°á»i dÃ¹ng, thÃ´ng tin thÃ nh pháº§n dinh dÆ°á»¡ng vÃ  mÃ´ hÃ¬nh **Há»c mÃ¡y/Deep Learning**. NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ nháº­p thÃ´ng tin cÃ¡ nhÃ¢n (tuá»•i, cÃ¢n náº·ng, chiá»u cao, má»¥c tiÃªu dinh dÆ°á»¡ng) vÃ  nháº­n Ä‘Æ°á»£c cÃ¡c Ä‘á» xuáº¥t mÃ³n Äƒn phÃ¹ há»£p vá»›i nhu cáº§u dinh dÆ°á»¡ng, sá»Ÿ thÃ­ch vÃ  cháº¿ Ä‘á»™ Äƒn uá»‘ng. Há»‡ thá»‘ng káº¿t há»£p phÃ¢n tÃ­ch dá»¯ liá»‡u, tiá»n xá»­ lÃ½ vÃ  mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n Ä‘á»ƒ tá»‘i Æ°u hÃ³a cháº¿ Ä‘á»™ Äƒn má»™t cÃ¡ch thÃ´ng minh vÃ  tiá»‡n lá»£i. ğŸš€
</p>

---

## ğŸŒŸ Giá»›i thiá»‡u há»‡ thá»‘ng

- **Dá»¯ liá»‡u dinh dÆ°á»¡ng:** Bao gá»“m calo, protein, carbohydrate, cháº¥t bÃ©o, vitamin vÃ  khoÃ¡ng cháº¥t.
- **MÃ´ hÃ¬nh AI:** Sá»­ dá»¥ng cÃ¡c thuáº­t toÃ¡n ML/DL (Random Forest, LSTM, hoáº·c Máº¡ng nÆ¡-ron) Ä‘á»ƒ gá»£i Ã½ thá»±c Ä‘Æ¡n.
- **Giao diá»‡n tÆ°Æ¡ng tÃ¡c:** Web app/GUI cho phÃ©p ngÆ°á»i dÃ¹ng nháº­p dá»¯ liá»‡u, nháº­n Ä‘á» xuáº¥t, Ä‘Ã¡nh giÃ¡ vÃ  lÆ°u láº¡i cÃ¡c bá»¯a Äƒn.
- **TÃ¹y chá»‰nh cÃ¡ nhÃ¢n:** Äiá»u chá»‰nh theo lÆ°á»£ng calo má»¥c tiÃªu, dá»‹ á»©ng, sá»Ÿ thÃ­ch mÃ³n Äƒn hoáº·c cháº¿ Ä‘á»™ Äƒn Ä‘áº·c biá»‡t (Vegetarian, Keto, Low-carbâ€¦).

---

## ğŸ—ï¸ Kiáº¿n trÃºc há»‡ thá»‘ng

Há»‡ thá»‘ng gá»“m 3 khá»‘i chÃ­nh:

1. **Khá»‘i Dá»¯ liá»‡u:** Thu tháº­p dá»¯ liá»‡u thá»±c pháº©m, thÃ nh pháº§n dinh dÆ°á»¡ng, dá»¯ liá»‡u ngÆ°á»i dÃ¹ng.
2. **Khá»‘i Xá»­ lÃ½ & AI:** Tiá»n xá»­ lÃ½ dá»¯ liá»‡u, chuáº©n hÃ³a, xÃ¢y dá»±ng vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n thá»±c Ä‘Æ¡n phÃ¹ há»£p.
3. **Khá»‘i Giao diá»‡n NgÆ°á»i dÃ¹ng:** Web app/GUI hiá»ƒn thá»‹ gá»£i Ã½ thá»±c Ä‘Æ¡n vÃ  cho phÃ©p tÆ°Æ¡ng tÃ¡c.

![Kiáº¿n trÃºc há»‡ thá»‘ng](images/architecture.png)

---

## ğŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

```
project/
â”‚
â”œâ”€ raw-data_recipe.csv # Dá»¯ liá»‡u gá»‘c cÃ¡c cÃ´ng thá»©c náº¥u Äƒn
â”œâ”€ Food_and_Nutrition__.csv # Dá»¯ liá»‡u thÃ´ng tin ngÆ°á»i dÃ¹ng
â”œâ”€ recipes_clean.csv # Dá»¯ liá»‡u Ä‘Ã£ lÃ m sáº¡ch
â”œâ”€ model_cal.pkl # MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n nhu cáº§u calo
â”œâ”€ model_prot.pkl # MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n nhu cáº§u protein
â”œâ”€ app.py # á»¨ng dá»¥ng Streamlit cho ngÆ°á»i dÃ¹ng
â”œâ”€ xu_ly_du_lieu.ipynb # Notebook tiá»n xá»­ lÃ½, huáº¥n luyá»‡n mÃ´ hÃ¬nh
â””â”€ README.md # HÆ°á»›ng dáº«n dá»± Ã¡nÂ  Â  Â  Â  
```


---

## ğŸ› ï¸ CÃ´ng nghá»‡ & YÃªu cáº§u Há»‡ thá»‘ng

| LÄ©nh vá»±c | CÃ´ng nghá»‡ | Chi tiáº¿t |
| :--- | :--- | :--- |
| **Dá»¯ liá»‡u** | Python, Pandas, NumPy, ast | Tiá»n xá»­ lÃ½, chuyá»ƒn Ä‘á»•i cáº¥u trÃºc dá»¯ liá»‡u dinh dÆ°á»¡ng (JSON $\to$ cá»™t). |
| **Há»c mÃ¡y (ML)** | scikit-learn (RandomForestRegressor) | Dá»± Ä‘oÃ¡n nhu cáº§u Calo/Protein cÃ¡ nhÃ¢n hÃ³a. |
| **Gá»£i Ã½ & PhÃ¢n loáº¡i** | TfidfVectorizer, KMeans | PhÃ¢n loáº¡i mÃ³n Äƒn thÃ nh 5 nhÃ³m cluster Ä‘á»ƒ gá»£i Ã½ mÃ³n thay tháº¿. |
| **Giao diá»‡n** | Streamlit | XÃ¢y dá»±ng Web App tÆ°Æ¡ng tÃ¡c (Sidebar, Báº£ng, Biá»ƒu Ä‘á»“). |

**YÃªu cáº§u Pháº§n má»m:** Python 3.x, vÃ  cÃ¡c thÆ° viá»‡n trong `requirements.txt` (`streamlit`, `scikit-learn`, `pandas`, `matplotlib`, `pickle`).

---

## ğŸ”¬ Khá»‘i Xá»­ lÃ½ Dá»¯ liá»‡u vÃ  Feature Engineering

Dá»¯ liá»‡u thÃ´ Ä‘Æ°á»£c chuáº©n hÃ³a Ä‘á»ƒ xÃ¢y dá»±ng Ground Truth cho mÃ´ hÃ¬nh AI vÃ  cÃ¡c tÃ­nh nÄƒng lá»c.

### 1. TÃ­nh toÃ¡n Chá»‰ sá»‘ CÆ¡ thá»ƒ & Má»¥c tiÃªu

* **Chá»‰ sá»‘ BMI:** TÃ­nh toÃ¡n dá»±a trÃªn cÃ¢n náº·ng (kg) vÃ  chiá»u cao (m).
    $$BMI = \frac{\text{weight\_kg}}{(\text{height\_m})^2}$$
* **Nhu cáº§u Calo (Target TDEE):** TÃ­nh TDEE dá»±a trÃªn cÃ´ng thá»©c BMR (Harris-Benedict hoáº·c Mifflin-St Jeor), má»©c Ä‘á»™ váº­n Ä‘á»™ng, vÃ  Ä‘iá»u chá»‰nh theo má»¥c tiÃªu/BMI.
    * **Äiá»u chá»‰nh theo BMI:** BMI > 25 $\to$ giáº£m **15%** TDEE; BMI < 18.5 $\to$ tÄƒng **15%** TDEE.
* **Nhu cáº§u Protein (Target Protein):** Thiáº¿t láº­p lÃ  **2g / kg** trá»ng lÆ°á»£ng cÆ¡ thá»ƒ (phÃ¹ há»£p vá»›i ngÆ°á»i táº­p luyá»‡n/kiá»ƒm soÃ¡t cÃ¢n náº·ng).

### 2. Tiá»n xá»­ lÃ½ Dá»¯ liá»‡u CÃ´ng thá»©c

* **LÃ m sáº¡ch:** Bá» cÃ¡c cá»™t khÃ´ng cáº§n thiáº¿t (`aver_rate`, `image_url`, v.v.).
* **Parse Dinh dÆ°á»¡ng:** Chuyá»ƒn Ä‘á»•i cá»™t `nutritions` (chuá»—i JSON) thÃ nh cÃ¡c cá»™t sá»‘ (`calories`, `protein`, `fat`, `carbohydrates`, v.v.).
* **Lá»c CÃ¡ nhÃ¢n:** XÃ¢y dá»±ng hÃ m lá»c mÃ³n Äƒn dá»±a trÃªn danh sÃ¡ch `Thá»±c pháº©m muá»‘n trÃ¡nh` vÃ  `Thá»±c pháº©m Æ°u tiÃªn` cá»§a ngÆ°á»i dÃ¹ng.

---

## ğŸ§  Huáº¥n luyá»‡n MÃ´ hÃ¬nh AI (Random Forest)

MÃ´ hÃ¬nh há»c mÃ¡y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ dá»± Ä‘oÃ¡n nhu cáº§u dinh dÆ°á»¡ng cÃ¡ nhÃ¢n hÃ³a.

* **Dá»¯ liá»‡u Äáº§u vÃ o (X):** CÃ¡c thÃ´ng sá»‘ cÆ¡ thá»ƒ Ä‘Ã£ Ä‘Æ°á»£c sá»‘ hÃ³a (`BMI`, `age`, `gender_num`, `height_cm`, `weight_kg`, `activity_num`).
* **Má»¥c tiÃªu Dá»± Ä‘oÃ¡n (Y):** `target_calories` vÃ  `target_protein`.
* **MÃ´ hÃ¬nh:** `RandomForestRegressor` Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»™c láº­p cho Calo (`model_cal.pkl`) vÃ  Protein (`model_prot.pkl`).
* **ÄÃ¡nh giÃ¡:** Sá»­ dá»¥ng **RÂ² Score**, **MAE**, vÃ  **RMSE** Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh so vá»›i Ground Truth.

---

## ğŸ’» á»¨ng dá»¥ng Streamlit vÃ  TÃ­nh nÄƒng Gá»£i Ã½

á»¨ng dá»¥ng web cho phÃ©p ngÆ°á»i dÃ¹ng tÆ°Æ¡ng tÃ¡c vÃ  nháº­n thá»±c Ä‘Æ¡n tá»©c thÃ¬.

### ğŸŒŸ TÃ­nh nÄƒng ChÃ­nh

* **Dá»± Ä‘oÃ¡n Nhu cáº§u:** Sá»­ dá»¥ng mÃ´ hÃ¬nh `RandomForestRegressor` Ä‘Ã£ lÆ°u (`.pkl`) Ä‘á»ƒ dá»± Ä‘oÃ¡n Calo vÃ  Protein má»¥c tiÃªu.
* **Clustering MÃ³n Äƒn (KMeans):**
    * Sá»­ dá»¥ng **TF-IDF trÃªn NguyÃªn liá»‡u** vÃ  **Chuáº©n hÃ³a Dinh dÆ°á»¡ng** lÃ m Ä‘áº§u vÃ o.
    * PhÃ¢n loáº¡i thÃ nh **5 NhÃ³m (Cluster)**: `Low-Calorie`, `High-Protein`, `Balanced`, `High-Fat`, `Carb-Heavy`.
    * Má»—i mÃ³n Äƒn Ä‘Æ°á»£c gÃ¡n má»™t **NhÃ³m mÃ³n** (Cluster Label).
* **Táº¡o Thá»±c Ä‘Æ¡n:** Chia tá»•ng Calo má»¥c tiÃªu thÃ nh 4 bá»¯a (SÃ¡ng, TrÆ°a, Tá»‘i, Phá»¥) theo tá»· lá»‡ pháº§n trÄƒm cá»‘ Ä‘á»‹nh. Gá»£i Ã½ mÃ³n Äƒn trong pháº¡m vi Calo má»¥c tiÃªu cá»§a tá»«ng bá»¯a.
* **Gá»£i Ã½ MÃ³n Thay tháº¿:** Äá» xuáº¥t cÃ¡c mÃ³n Äƒn **cÃ¹ng nhÃ³m Cluster** vá»›i mÃ³n Äƒn hiá»‡n táº¡i, cho phÃ©p ngÆ°á»i dÃ¹ng thay tháº¿ vÃ  cáº­p nháº­t dinh dÆ°á»¡ng.
* **LÆ°u Lá»‹ch sá»­:** LÆ°u láº¡i tá»‘i Ä‘a 10 thá»±c Ä‘Æ¡n Ä‘Ã£ táº¡o.

### ğŸ“Š VÃ­ dá»¥ Káº¿t quáº£ Thá»±c Ä‘Æ¡n

| Bá»¯a | MÃ³n Äƒn | Calo | Protein (g) | Cháº¥t bÃ©o (g) | NhÃ³m mÃ³n |
| :---: | :---: | :---: | :---: | :---: | :---: |
| Bá»¯a sÃ¡ng | Trá»©ng á»‘p la | 300 | 20 | 15 | High-Protein |
| Bá»¯a trÆ°a | CÆ¡m gÃ  | 550 | 35 | 20 | Balanced |
| Bá»¯a tá»‘i | Salad cÃ¡ há»“i | 400 | 25 | 18 | Low-Calorie |
| Bá»¯a phá»¥ | Sá»¯a chua | 150 | 8 | 5 | Balanced |

---

## ğŸš€ HÆ°á»›ng dáº«n Cháº¡y á»¨ng dá»¥ng

### 1. ğŸ“‚ Chuáº©n bá»‹ Dá»¯ liá»‡u Gá»‘c

Táº£i cÃ¡c táº­p dá»¯ liá»‡u gá»‘c vá» vÃ  Ä‘áº·t chÃºng trong thÆ° má»¥c chÃ­nh cá»§a dá»± Ã¡n:

| TÃªn file | LiÃªn káº¿t Táº£i xuá»‘ng |
| :--- | :--- |
| `raw-data_recipe.csv` | [Link Google Drive] |
| `Food_and_Nutrition__.csv` | [Link Google Drive] |

### 2. ğŸ§  Tiá»n xá»­ lÃ½ vÃ  Huáº¥n luyá»‡n MÃ´ hÃ¬nh

* **Cháº¡y Notebook:** Má»Ÿ file `xu_ly_du_lieu.ipynb` (hoáº·c tÃªn file notebook tÆ°Æ¡ng á»©ng) vÃ  thá»±c hiá»‡n **Run All**.

    ```bash
    Run All trong file ipynb
    # BÆ°á»›c nÃ y sáº½ táº¡o ra recipes_clean.csv, model_cal.pkl, model_prot.pkl
    ```

### 3. âš™ï¸ Khá»Ÿi Ä‘á»™ng á»¨ng dá»¥ng Streamlit

* **CÃ i Ä‘áº·t ThÆ° viá»‡n:** Äáº£m báº£o báº¡n Ä‘Ã£ cÃ i Ä‘áº·t táº¥t cáº£ cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t (`pip install -r requirements.txt`).

* **Khá»Ÿi Ä‘á»™ng á»¨ng dá»¥ng:** Cháº¡y á»©ng dá»¥ng báº±ng lá»‡nh sau trong terminal:

    ```bash
    streamlit run app.py
    # LÆ°u Ã½: Náº¿u tÃªn file lÃ  app_multilang_full.py, hÃ£y cháº¡y lá»‡nh tÆ°Æ¡ng á»©ng.
    ```

### 4. ğŸ½ï¸ Sá»­ dá»¥ng Há»‡ thá»‘ng

* Nháº­p thÃ´ng tin cÃ¡ nhÃ¢n trÃªn **Sidebar**, sau Ä‘Ã³ nháº¥n **Táº¡o thá»±c Ä‘Æ¡n AI** Ä‘á»ƒ nháº­n gá»£i Ã½.

---

## âœ… Káº¿t luáº­n vÃ  HÆ°á»›ng phÃ¡t triá»ƒn

### ğŸ“Œ GiÃ¡ trá»‹ Há»‡ thá»‘ng

* **CÃ¡ nhÃ¢n hÃ³a SÃ¢u:** Káº¿t há»£p phÃ¢n tÃ­ch BMI, TDEE, Má»¥c tiÃªu vÃ  ThÃ³i quen Äƒn uá»‘ng.
* **Äá»™ tin cáº­y:** Sá»­ dá»¥ng MÃ´ hÃ¬nh AI (Random Forest) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nhu cáº§u dinh dÆ°á»¡ng, tÄƒng cÆ°á»ng tÃ­nh chÃ­nh xÃ¡c so vá»›i cÃ´ng thá»©c truyá»n thá»‘ng.
* **TÃ­nh linh hoáº¡t:** Cho phÃ©p ngÆ°á»i dÃ¹ng tÃ¹y chá»‰nh vÃ  thay tháº¿ mÃ³n Äƒn theo nhÃ³m dinh dÆ°á»¡ng.

### ğŸŒŸ Má»Ÿ rá»™ng trong TÆ°Æ¡ng lai

* **Tá»‘i Æ°u hÃ³a VÄ© mÃ´:** Ãp dá»¥ng cÃ¡c thuáº­t toÃ¡n **Tá»‘i Æ°u hÃ³a (Optimization)** Ä‘á»ƒ Ä‘áº£m báº£o tá»•ng lÆ°á»£ng Calo, Protein, Carb vÃ  Fat trong ngÃ y Ä‘áº¡t chÃ­nh xÃ¡c má»¥c tiÃªu Ä‘á» ra (thay vÃ¬ chá»‰ cá»‘ gáº¯ng Ä‘áº¡t má»¥c tiÃªu Calo cho tá»«ng bá»¯a).
* **RÃ ng buá»™c Bá»‡nh lÃ½:** ThÃªm logic lá»c mÃ³n Äƒn theo cÃ¡c bá»‡nh lÃ½ Ä‘áº·c biá»‡t (vÃ­ dá»¥: TÄƒng huyáº¿t Ã¡p $\to$ giáº£m Sodium).

---

## ğŸ¤ TÃC GIáº¢ ğŸ‘¥

Dá»± Ã¡n Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi:

* **Tráº§n Há»“ng QuÃ¢n**

Â© 2025 NHÃ“M 20, KHOA CÃ”NG NGHá»† THÃ”NG TIN, TRÆ¯á»œNG Äáº I Há»ŒC Äáº I NAM.
